<app-navbar></app-navbar>

<app-not-found *ngIf="notFound"></app-not-found>
<app-unexpected-error *ngIf="unexpected"></app-unexpected-error>

<div *ngIf="!notFound && !unexpected" class="bg-primary">
    <div class="container-sm py-3 py-sm-4 py-lg-5 d-flex gap-3 flex-column flex-lg-row">
        <div class="custom-card galeria-container bg-lighter p-0">
            <p-galleria [value]="product.fotos" [circular]="true" [showThumbnails]="false" [showItemNavigators]="true"
                [showIndicators]="true" [changeItemOnIndicatorHover]="true" [showIndicatorsOnItem]="true">
                <ng-template pTemplate="item" let-item>
                    <div class="image-galleria-template d-flex justify-content-center align-items-center">
                        <img [src]="mediaUrl + item" />
                    </div>
                </ng-template>
            </p-galleria>
        </div>
        <div class="custom-card w-100">
            <div class="d-flex flex-column justify-content-around h-100">
                <div>
                    <a *ngIf="product.usuario.negocio !== null" [routerLink]="['/profile', product.usuario.id]">
                        <small class="small-link">{{ product.usuario.negocio }}</small>
                    </a>
                    <a *ngIf="product.usuario.negocio === null" href="">
                        <small class="small-link">{{ product.usuario.nombre }} {{ product.usuario.apellido }}</small>
                    </a>
                    <h3>{{ product.titulo }}</h3>
                    <ng-template #t let-fill="fill">
                        <span class="star" [class.full]="fill === 100">
                            <span class="half" [style.width.%]="fill">&#9733;</span>&#9733;
                        </span>
                    </ng-template>
                    <div class="d-flex gap-2 align-items-center">
                        <ngb-rating [(rate)]="product.puntuacion" [starTemplate]="t" [readonly]="true" [max]="5">
                        </ngb-rating>
                        <h5 *ngIf="product.puntuacion !== null" class="mb-0 font-weight-normal">{{ product.puntuacion }}
                        </h5>
                        <h6 *ngIf="product.puntuacion === null" class="mb-0 font-weight-normal">No hay datos</h6>
                    </div>
                </div>
                <h1>$ {{ product.precio }}</h1>
                <a class="link-button align-self-sm-center" target="_blank"
                    href="https://wa.me/{{ product.usuario.celular }}?text={{ mensajeContacto }}">
                    <button pButton pRipple type="button" label="Contactar" icon="pi pi-whatsapp"
                        class="p-button-lg button-responsive"></button>
                </a>
                <div class="mt-3">
                    <h6>Categorías:</h6>
                    <div class="d-flex flex-wrap gap-2 justify-content-center">
                        <a *ngFor="let categoria of product.categoria" class="link-button align-self-sm-center"
                            [routerLink]="'.'">
                            <button pButton pRipple type="button" label="{{categoria}}"
                                class="p-button-sm categories-button"></button>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div *ngIf="!notFound && !unexpected" class="bg-lighter">
    <div class="container-sm d-flex gap-5 flex-column flex-lg-row">
        <div>
            <div class="product-info py-3 py-sm-4 py-lg-5">
                <h2>Descripción</h2>
                <p class="mb-0 text-justify">{{ product.descripcion }} Lorem ipsum dolor sit amet consectetur adipisicing elit.
                    Quos temporibus at nesciunt quis sunt porro nisi unde pariatur culpa laboriosam cum nostrum,
                    consequatur dolorem dolore delectus laudantium quasi maxime? Libero!</p>
                <!--<div class="custom-card">
                    <p class="mb-0">{{ product.descripcion }} Lorem ipsum dolor sit amet consectetur adipisicing elit.
                        Quos temporibus at nesciunt quis sunt porro nisi unde pariatur culpa laboriosam cum nostrum,
                        consequatur dolorem dolore delectus laudantium quasi maxime? Libero!</p>
                </div>-->
            </div>
            <div class="product-info pb-3 pb-sm-4 pb-lg-5">
                <h2>Comentarios</h2>
                <!--TODO: Agregar la sección para enviar comentarios-->
                <div *ngIf="comentarios !== null" class="d-flex flex-column gap-3">
                    <div *ngFor="let coment of comentarios" class="custom-card">
                        <div class="d-flex gap-3 justify-content-between">
                            <h5>{{ coment.nombre }}</h5>
                            <small class="text-right">{{ coment.creado | date:'dd/LL/YYYY, HH:mm' }}</small>
                        </div>
                        <ng-template #t let-fill="fill">
                            <span class="star" [class.full]="fill === 100">
                                <span class="half" [style.width.%]="fill">&#9733;</span>&#9733;
                            </span>
                        </ng-template>
                        <ngb-rating [(rate)]="coment.puntuacion" [starTemplate]="t" [readonly]="true" [max]="5">
                        </ngb-rating>
                        <p class="mb-0">{{ coment.texto }}</p>
                    </div>
                </div>
                <div *ngIf="comentarios === null" class="d-flex flex-column gap-3">
                    <div class="custom-card text-center">
                        <h5 class="mb-0">Aún no hay comentarios.</h5>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex flex-column">
            <div class="py-3 py-sm-4 py-lg-5 relacionados">
                <h3>Más del vendedor</h3>
                <div class="d-flex flex-column gap-3">
                    <div class="custom-card c-pointer" *ngFor="let product of productosVendedor">
                        <p-galleria [value]="product.fotos" [circular]="true" [showItemNavigators]="true"
                            [showThumbnails]="false" [showIndicators]="false" [changeItemOnIndicatorHover]="true"
                            [showIndicatorsOnItem]="true">
                            <ng-template pTemplate="item" let-item>
                                <div class="image-galleria-template d-flex justify-content-center align-items-center">
                                    <img [src]="mediaUrl + item" [routerLink]="['/product',product.id]" />
                                </div>
                            </ng-template>
                        </p-galleria>
                        <div [routerLink]="['/product',product.id]" class="c-pointer">
                            <h2 class="precio mt-4">$ {{product.precio}}</h2>
                            <h5 class="titulo">{{product.titulo}}</h5>
                            <small>{{product.usuario.nombre}} {{product.usuario.apellido}}</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pb-3 pb-sm-4 pb-lg-5 relacionados">
                <h3>Relacionado</h3>
                <div class="d-flex flex-column gap-3">
                    <div class="custom-card c-pointer" *ngFor="let product of productosRelacionados">
                        <p-galleria [value]="product.fotos" [circular]="true" [showItemNavigators]="true"
                            [showThumbnails]="false" [showIndicators]="false" [changeItemOnIndicatorHover]="true"
                            [showIndicatorsOnItem]="true">
                            <ng-template pTemplate="item" let-item>
                                <div class="image-galleria-template d-flex justify-content-center align-items-center">
                                    <img [src]="mediaUrl + item" [routerLink]="['/product',product.id]" />
                                </div>
                            </ng-template>
                        </p-galleria>
                        <div [routerLink]="['/product',product.id]" class="c-pointer">
                            <h2 class="precio mt-4">$ {{product.precio}}</h2>
                            <h5 class="titulo">{{product.titulo}}</h5>
                            <small>{{product.usuario.nombre}} {{product.usuario.apellido}}</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<app-footbar></app-footbar>